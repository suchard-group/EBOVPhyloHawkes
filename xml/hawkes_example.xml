<?xml version="1.0" standalone="yes"?>
<beast>

	<taxa id="taxa">
		<taxon id="p1.time">
			<attr name="dateDecimal">1</attr>
			<attr name="Deff_2">-3.162629347 0.380396808 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p2.time">
			<attr name="dateDecimal">2</attr>
			<attr name="Deff_2">-3.162629347 0.380396808 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p3.time">
			<attr name="dateDecimal">3</attr>
			<attr name="Deff_2">-0.888754177 -2.105695221 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p4.time">
			<attr name="dateDecimal">4</attr>
			<attr name="Deff_2">-0.888754177 -2.105695221 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p5.time">
			<attr name="dateDecimal">5</attr>
			<attr name="Deff_2">-0.888754177 -2.105695221 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p6.time">
			<attr name="dateDecimal">6</attr>
			<attr name="Deff_2">2.329429317 -0.339018347 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p7.time">
			<attr name="dateDecimal">7</attr>
			<attr name="Deff_2">6.632645669 -0.576121462 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p8.time">
			<attr name="dateDecimal">8</attr>
			<attr name="Deff_2">-2.786062946 -1.202535113 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p9.time">
			<attr name="dateDecimal">9</attr>
			<attr name="Deff_2">2.329429317 -0.339018347 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
		<taxon id="p10.time">
			<attr name="dateDecimal">10</attr>
			<attr name="Deff_2">-1.549236912 -0.561964482 1 1 1 1</attr>
			<attr name="rate">1.0</attr>
		</taxon>
	</taxa>

	<exponentialGrowth id="exponential" units="years">
		<populationSize>
			<parameter id="exponential.popSize" value="1.0" lower="0.0"/>
		</populationSize>
		<growthRate>
			<parameter id="exponential.growthRate" value="0.0"/>
		</growthRate>
	</exponentialGrowth>

	<!-- Generate a random starting tree under the coalescent process            -->
	<coalescentSimulator id="startingTree">
		<taxa idref="taxa"/>
		<exponentialGrowth idref="exponential"/>
	</coalescentSimulator>

	<treeModel id="treeModel">
		<newick idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
		<nodeTraits rootNode="false" internalNodes="false" leafNodes="true" traitDimension="1" name="rate" asMatrix="true">
			<parameter id="randomRates"/>
		</nodeTraits>
	</treeModel>

	<multivariateDiffusionModel id="diffusionModel">
		<precisionMatrix>
			<matrixParameter id="precision.mat">
				<parameter id="precision" value="0.05"/>
			</matrixParameter>
		</precisionMatrix>
	</multivariateDiffusionModel>

	<traitDataLikelihood id="traitLikelihood" traitName="rate" useTreeLength="true" scaleByTime="true" reciprocalRates="false" integrateInternalTraits="true" cacheBranches="true">
		<multivariateDiffusionModel idref="diffusionModel"/>
		<treeModel idref="treeModel"/>
		<traitParameter>
<!-- 			<fastMatrixParameter idref="randomEffects" rows="1" columns="1610" test="true" signalComponents="false"/> -->
			<fastMatrixParameter idref="randomRates"/>
		</traitParameter>
		<jitter window="0.05" duplicatesOnly="false">
			<parameter idref="randomRates"/>
		</jitter>
		<conjugateRootPrior>
			<meanParameter>
				<parameter value="0.0"/>
			</meanParameter>
			<priorSampleSize>
				<parameter value="0.001"/>
			</priorSampleSize>
		</conjugateRootPrior>
	</traitDataLikelihood>

    <hawkesLikelihood id="hawkesLikelihood" hphDimension="2"  timeTrait="dateDecimal" locationTrait="Deff_2">
    	<times>
    		<taxa idref="taxa"/>
    	</times>
        <locations>
			<fastMatrixParameter id="locations" rows="2" columns="10" signalComponents="false">
				<parameter id="p1.loc" value="0.7533110462177826  2.1500426178447376"/>
				<parameter id="p2.loc" value="2.0143546656986526 -1.7702308382032059"/>
				<parameter id="p3.loc" value="-0.3551344603718911  0.8646535945653890"/>
				<parameter id="p4.loc" value="2.0281678426422185 -1.7201558981610894"/>
				<parameter id="p5.loc" value="-2.2168744511424365  0.1341256681411810"/>
				<parameter id="p6.loc" value="0.7583961780010422 -0.0758265646523722"/>
				<parameter id="p7.loc" value="-1.3061852590117029  0.8583005443759202"/>
				<parameter id="p8.loc" value="-0.8025195687037929  0.3449003481022697"/>
				<parameter id="p9.loc" value="-1.7922408344611376 -0.5824526901077771"/>
				<parameter id="p10.loc" value="-0.0420324540227439  0.7861703759254022"/>																				
			</fastMatrixParameter>
        </locations>
        <sigmaXprec>
            <parameter id="sigmaXprec" value="1.46836017" lower="0.0"/>
        </sigmaXprec>
        <tauXprec>
            <parameter id="tauXprec" value="0.26153185" lower="0.0"/>
        </tauXprec>
        <tauTprec>
            <parameter id="tauTprec" value="0.21233766" lower="0.0"/>
        </tauTprec>
        <omega>
            <parameter id="omega" value="0.02438852" lower="0.0"/>
        </omega>
        <theta>
            <parameter id="theta" value="0.04791975" lower="0.0"/>
        </theta>
        <mu0>
            <parameter id="mu0" value="0.49226404" lower="0.0"/>
        </mu0>
    </hawkesLikelihood>
    
    <report>
	    <hawkesLikelihood idref="hawkesLikelihood"/>
    </report>
    
    <operators id="operators" optimizationSchedule="log">
    
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="sigmaXprec"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="tauXprec"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="tauTprec"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="omega"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="theta"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="mu0"/>
		</scaleOperator>
	</operators>
	
<!-- 
	<mcmc id="mcmc" chainLength="1000000" fullEvaluation="0" autoOptimize="true">
		<posterior id="posterior">
			<prior id="prior">
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="sigmaXprec"/>
				</gammaPrior>
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="tauXprec"/>
				</gammaPrior>
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="tauTprec"/>
				</gammaPrior>
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="omega"/>
				</gammaPrior>
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="theta"/>
				</gammaPrior>
				<gammaPrior shape="0.001" scale="1000" offset="0.0">
					<parameter idref="mu0"/>
				</gammaPrior>
			</prior>
			<likelihood id="likelihood">
				<hawkesLikelihood idref="hawkesLikelihood"/>
			</likelihood>
		</posterior>
		
		<operators idref="operators"/>
		
		<log id="screenLog" logEvery="500">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior"/>
			</column>
			<column label="Prior" dp="4" width="12">
				<prior idref="prior"/>
			</column>
			<column label="Likelihood" dp="4" width="12">
				<likelihood idref="likelihood"/>
			</column>

            <column label="sigmaXprec" sf="6" width="12">
				<parameter idref="sigmaXprec"/>
			</column>
		</log>
		
		<log id="parametersLog" logEvery="100" fileName="HawkesExample.log">
			<posterior idref="posterior"/>
			<prior idref="prior"/>
			<likelihood idref="likelihood"/>		
			<parameter idref="sigmaXprec"/>
			<parameter idref="tauXprec"/>
			<parameter idref="tauTprec"/>
			<parameter idref="omega"/>
			<parameter idref="theta"/>
			<parameter idref="mu0"/>
		</log>		
	</mcmc>
 -->


</beast>
